---
title: 按鈕監聽器
date: 2017-08-30 15:38:34
tags:
- Android
- 監聽器
- 行雲部落格
---

* 本文曾發佈在 [https://blog.cmrdb.cs.pu.edu.tw/?p=341](https://blog.cmrdb.cs.pu.edu.tw/?p=341)

雖然上次介紹了Kotlin，但目前開發Android大部分還是以Java為主，今天就要教大家用程式碼控制TextView的文字內容，主要是介紹按鈕(Button)的監聽器(Listener)控制。
<!-- more -->

# 監聽器
常見的監聽器有幾個 
> 之間差別可以參考 : http://blog.csdn.net/eclipsexys/article/details/8785149 

- `OnClickListener` (點擊) : 在手指**按下再放開**後才執行
- `OnLongClickListener` (長按) : 手指按住不放時執行
- `OnTouchListener` (觸碰) : 手指一碰到按鈕就執行，與OnClick不同的是不需等到手指放開

# 建立專案
首先建立一個新專案( [可以參考上次的文章](http://blog.cmrdb.cs.pu.edu.tw/?p=291) )

# 排版
在畫面上新增一個TextView、一個Button
![image](image.png) 

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    tools:context="com.example.yr.helloworld.MainActivity">

    <TextView
        android:id="@+id/textView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="30dp"
        android:text="TextView" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="horizontal">

        <Button
            android:id="@+id/btn"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="Button" />

    </LinearLayout>

</LinearLayout>
```

# 程式碼

1. 宣告 
```java 
Button btn;
TextView txv;
```

1. 與畫面物件配對
```java
btn = (Button) findViewById(R.id.btn);
txv = (TextView) findViewById(R.id.textView);
```

1. 設置OnClick監聽器
```java
btn.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View view) {
        txv.setText("OnClick");
    }
});
```

1. 設置OnLongClick監聽器
```java 
btn.setOnLongClickListener(new View.OnLongClickListener() {
    @Override
    public boolean onLongClick(View view) {
        txv.setText("OnLongClick");
            return false;
    }
});
```

1. 設置OnTouch監聽器
```java
btn.setOnTouchListener(new View.OnTouchListener() {
    @Override
    public boolean onTouch(View view, MotionEvent motionEvent) {
        txv.setText("OnTouch");
            return false;
    }
});
```

# 完整程式碼

```java
package com.example.yr.helloworld;

import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.view.MotionEvent;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class MainActivity extends AppCompatActivity {

    Button btn;
    TextView txv;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        btn = (Button) findViewById(R.id.btn);
        txv = (TextView) findViewById(R.id.textView);

        btn.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                txv.setText("OnClick");
            }
        });

        btn.setOnLongClickListener(new View.OnLongClickListener() {
            @Override
            public boolean onLongClick(View view) {
                txv.setText("OnLongClick");
                return false;
            }
        });

        btn.setOnTouchListener(new View.OnTouchListener() {
            @Override
            public boolean onTouch(View view, MotionEvent motionEvent) {
                txv.setText("OnTouch");
                return false;
            }
        });
    }
}
```
